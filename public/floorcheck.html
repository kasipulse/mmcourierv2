<div class="panel">
  <h1>Floor Check</h1>
  <p>Scan parcels currently on the floor.</p>
  <input type="text" id="scanInput" placeholder="Scan Waybill #" />
  <button onclick="scanParcel()">Scan</button>
  <ul id="floorList"></ul>
</div>

<script>
function initPanel() {
  async function loadFloor() {
    const { data } = await supabase.from('parcels').select('*').eq('status','Pending');
    const ul = document.getElementById('floorList');
    ul.innerHTML='';
    data.forEach(p=>{
      const li=document.createElement('li');
      li.textContent=`${p.tracking_number} - ${p.receiver}`;
      ul.appendChild(li);
    });
  }
  async function scanParcel() {
    const code=document.getElementById('scanInput').value.trim();
    if(!code) return alert('Scan a waybill');
    await supabase.from('parcels').update({status:'Scanned'}).eq('tracking_number',code);
    document.getElementById('scanInput').value='';
    loadFloor();
  }
  window.scanParcel=scanParcel;
  loadFloor();
}
</script>
