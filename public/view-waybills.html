<div class="panel">
  <h1>Imported Waybills</h1>
  <table border="1" cellpadding="4" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Tracking #</th>
        <th>Sender</th>
        <th>Recipient</th>
        <th>Address</th>
        <th>Customer</th>
        <th>Status</th>
        <th>Imported At</th>
      </tr>
    </thead>
    <tbody id="waybillBody"></tbody>
  </table>
</div>

<script>
function initPanel() {
  async function loadWaybills() {
    const { data, error } = await supabase.from('parcels').select('*').order('imported_at', {ascending:false});
    if(error){ alert(error.message); return; }
    const tbody = document.getElementById('waybillBody');
    tbody.innerHTML = '';
    data.forEach(r=>{
      const tr=document.createElement('tr');
      tr.innerHTML = `
        <td>${r.tracking_number||''}</td>
        <td>${r.sender||''}</td>
        <td>${r.receiver||''}</td>
        <td>${r.address||''}</td>
        <td>${r.customer||''}</td>
        <td>${r.status||''}</td>
        <td>${r.imported_at?new Date(r.imported_at).toLocaleString():''}</td>
      `;
      tbody.appendChild(tr);
    });
  }
  loadWaybills();
}
</script>
